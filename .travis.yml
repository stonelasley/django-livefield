language: python
python:
  - "2.7"
  - "3.2"
  - "3.3"
env:
  - DJANGO_VERSION_CEILING=1.7 DJANGO_DB_ENGINE=sqlite
  - DJANGO_VERSION_CEILING=1.7 DJANGO_DB_ENGINE=postgres DJANGO_DB_NAME=testdb DJANGO_DB_USER=postgres
  - DJANGO_VERSION_CEILING=1.7 DJANGO_DB_ENGINE=mysql DJANGO_DB_NAME=testdb DJANGO_DB_USER=travis
  - DJANGO_VERSION_CEILING=1.8 DJANGO_DB_ENGINE=sqlite
  - DJANGO_VERSION_CEILING=1.8 DJANGO_DB_ENGINE=postgres DJANGO_DB_NAME=testdb DJANGO_DB_USER=postgres
  - DJANGO_VERSION_CEILING=1.8 DJANGO_DB_ENGINE=mysql DJANGO_DB_NAME=testdb DJANGO_DB_USER=travis
install:
  - pip install -v "Django<$DJANGO_VERSION_CEILING" psycopg2
  - if [[ $TRAVIS_PYTHON_VERSION == 2* ]]; then pip install -v MySQL-python; else pip install -v mysqlclient; fi
  - if [[ $TRAVIS_PYTHON_VERSION == 3.2 ]]; then pip install -v logilab-common==0.62 astroid==1.2 pylint==1.3; else pip install -v flake8 pylint pylint-django; fi
  - ""
  - "pip install -e ."
before_script:
  - "mysql -e 'create database testdb;'"
  - "psql -c 'create database testdb;' -U postgres"
script:
  - "python setup.py test"
  - "./lint.sh"
